<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مستشهد</title>
    <link rel="stylesheet" id="main_stylesheet" href="static/styles/setup_2/main_style.css">

    <link rel="stylesheet" id="stylesheet" href="{% if mode == 'light' %}static/styles/setup_2/light_style.css{% else %}static/styles/setup_2/dark_style.css{% endif %}">
    <style>
        @font-face {
            font-family: 'NotoKufiArabic-Regular';
            src: url('static/styles/Noto_Kufi_Arabic/static/NotoKufiArabic-Regular.ttf') format('truetype');
            /* You can also include other font formats for better compatibility */
        }
        /*body {*/
        /*    margin: 0; !* Remove default margin *!*/
        /*    padding: 0; !* Remove default padding *!*/
        /*    background-image: url('static/2.jpg'); !* Replace with the path to your image *!*/
        /*    background-size: cover; !* Cover the entire viewport *!*/
        /*    background-position: center; !* Center the image *!*/
        /*    background-repeat: no-repeat; !* Do not repeat the image *!*/
        /*    height: 100vh; !* Set the height to 100% of the viewport height *!*/
        /*    display: flex;*/
        /*    justify-content: center;*/
        /*    align-items: center;*/
        /*    color: #ffffff; !* Set text color to be visible on the background *!*/
        /*}*/
    </style>
</head>
<body>

<header>
    <a href="/"><img src="/static/images/logo.png" alt="logo"></a>
</header>

<div class="container">
    <form action="/change_the_setup" method="post">
        <button type="submit" name="destination" value="3" style="
                        background: #222140;
                        color: #ffffff;
                        padding: 4px;
                        font-size: 16px;
                        display: inline-block;
                        width: 180px;
                        margin-bottom: 5px;
                        cursor: pointer;
                        direction: rtl;
                        margin-left: 24px;
                        ">شارك في تطوير معجم الرياض!</button>
        <button type="submit" name="destination" value="2" style="
                        background: #222140;
                        color: #02fd00;
                        padding: 4px;
                        font-size: 16px;
                        display: inline-block;
                        margin-left: 266px;
                        width: 160px;
                        margin-bottom: 5px;
                        cursor: pointer;
                        ">استخدم معاني معجم الرياض</button>
        <button type="submit" name="destination" value="1" style="
                        background: #222140;
                        color: #ffffff;
                        padding: 4px;
                        font-size: 16px;
                        display: inline-block;
                        width: 160px;
                        margin-bottom: 5px;
                        cursor: pointer;
                        ">أدخل المعاني بنفسك</button>

    </form>
    <form id="examples_search_form" action="/get_examples_setup_2" method="POST">
        <label title="اكتب الكلمة مثل: 'يأكل'" for="word_input" class="word_label" >الكلمة:</label>
        <input placeholder="مثال: يأكل" title="اكتب الكلمة مثل: 'يأكل'" type="text" id="word_input" class="word_input" name="word" value="{{word}}" {% if list_of_meanings_dicts %}readonly{% endif %} style="{% if list_of_meanings_dicts %}color: gray;{% endif %}">

        <img src="static/images/drop_down.png" style="width: 21px;position: absolute;margin: 22px  0 0 34px;">        <label title="اختر معنى الكلمة" for="word_input" class="meaning_label">المعنى:</label>
        <select title="اختر معنى الكلمة" class="dropdown-select" name="meaning" id="type-select" {% if not list_of_meanings_dicts or list_of_meanings_dicts and word and examples %} style="color: gray;" readonly {% endif %}>
            {% if not list_of_meanings_dicts %}
            <option >لعرض المعاني: قم بكتابة الكلمة ثم اضغط على "البحث"</option>
            {% endif %}
            {% if list_of_meanings_dicts %}
            {% for item in list_of_meanings_dicts %}
            <option value="{{ item['meaning'] }}" title="{{ item['word_with_diacr'] + ': ' + item['meaning'] }}">
                {{ item['word_with_diacr'] + ": " + ' '.join(item['meaning'].split()[:5]) + ('...' if item['meaning'].split()|length > 5 else '') }}
            </option>
            {% endfor %}
            {% endif %}
        </select>


        <label title="اختر مصدر الأمثلة" class="resource_type_lable" >مصدر الأمثلة:</label>
        <div class="type_button_container">
            <div id="news"  title="الأخبار" class="type_button" onclick="toggleTypeButton(event, 'news')"><img title="الأخبار" class="resource_type_icon" src="static/images/News_icon.png" alt="News"></div>
            <div id="poetry"  title="الشّعر العربي" class="type_button" onclick="toggleTypeButton(event, 'poetry')"><img title="الشّعر العربي" class="resource_type_icon" src="static/images/Poetry_icon.png" alt="Poetry"></div>
            <div id="hadith"  title="كتب السُّنة النبوية" class="type_button" onclick="toggleTypeButton(event, 'hadith')"><img title="كتب السُّنة النبوية" class="resource_type_icon" src="static/images/Sunnah_icon.png" alt=hadith"></div>
            <div id="quraan"  title="القرآن الكريم" class="type_button" onclick="toggleTypeButton(event, 'quraan')"><img title="القرآن الكريم" class="resource_type_icon" src="static/images/Quran_icon.png" alt="Quran"></div>
            <div id="all"  title="جميع المصادر" class="type_button" onclick="toggleTypeButton(event, 'all')"><img title="جميع المصادر" class="resource_type_icon" src="static/images/All_icon.png" alt="All"></div>

            <input type="hidden" id="type_hiddenInput" name="resource_type" value="{{resource_type}}">
        </div>

        <input title="اضغط لإدخال كلمة جديدة" value="بحث جديد" class="search-button" id="new_search_button" onclick="new_search()" style="color: gray;margin: -47px 240px 0 0;color: #e40000;background: gold">
        <input type="submit" value="البحث" id="search_submit" class="search-button" {% if list_of_meanings_dicts and word and examples %} style="color: gray;" disabled {% endif %}>
        <div id="overlay">
            <div id="loader"></div>
            <span style="direction: rtl">جاري البحث...</span>
        </div>
    </form>
    <ul id="examples_ul">
        {% if examples %}
            {% for highlighted_word_with_examples in examples%}
            <span class="examples_word">{{highlighted_word_with_examples[0]}}</span>

            {% for example in highlighted_word_with_examples[1] %}
            <li>
                {{example|safe}}
            </li>
            {% endfor %}


            {% endfor %}
        {% endif %}
    </ul>
    <form id="set_mode_form" action="/set_mode" method="POST">
        <input type="hidden" id="mode_hiddenInput" name="mode" value="{{mode}}">

        <div id="toggle-circle" onclick="toggleMode()" style="background-color: {{ 'rgb(50, 50, 50)' if mode == 'light' else '#3498db' }}" >
            <span id="mode-icon">{{ "☀️" if mode == 'dark' else '🌙' }}</span>
        </div>
    </form>
</div>



<script>
    // Get references to the button and your Flask variables
    var button = document.getElementById('new_search_button');
    var list_of_meanings_dicts = {{ list_of_meanings_dicts|default('undefined')|tojson|safe }};
    var word = "{{ word }}";

    // Check conditions and set the style accordingly
    if (list_of_meanings_dicts !== 'undefined' && word) {
        button.style.display = 'inline';
    } else {
        button.style.display = 'none';
    }
    function new_search(){
        // Enable the button
        var button = document.getElementById("search_submit");
        button.disabled = false;
        button.style.color = "#ffbd2c"

        // Make the select element readonly and set its value to 'لعرض المعاني: قم بكتابة الكلمة ثم اضغط على "البحث"'
        var selectElement = document.getElementById("type-select");
        while (selectElement.firstChild) {
            selectElement.removeChild(selectElement.firstChild);
        }

        var selectElement = document.getElementById("type-select");
        var optionValue = 'لعرض المعاني: قم بكتابة الكلمة ثم اضغط على "البحث"';

        // Create a new option element
        var newOption = document.createElement("option");
        newOption.value = optionValue;
        newOption.text = optionValue;

        // Add the new option to the select element
        selectElement.add(newOption);

        // Set the new option as the selected option
        selectElement.value = optionValue;
        selectElement.disabled = true;
        selectElement.style.color = "gray";

        // Enable the text input and set its value to empty
        var textInput = document.getElementById("word_input");
        textInput.readOnly = false;
        textInput.value = "";
        textInput.style.color = "#e41320";

        var ulElement = document.getElementById("examples_ul");
        while (ulElement.firstChild) {
            ulElement.removeChild(ulElement.firstChild);
        }
        document.getElementById("new_search_button").style.display = "none";
    }
    document.addEventListener("DOMContentLoaded", function () {
        // Get the value of the hidden input
        var hiddenInputValue = document.getElementById("type_hiddenInput").value;

        // Add 'active' class to the button with the corresponding ID
        var correspondingButton = document.getElementById(hiddenInputValue);
        if (correspondingButton) {
            correspondingButton.classList.add("active");
        }
    });
    function toggleTypeButton(event, buttonId) {
        event.preventDefault();
        // Get all buttons
        var buttons = document.querySelectorAll('.type_button');

        // Loop through each button
        buttons.forEach(function(button) {
            // Remove 'active' class from all buttons
            button.classList.remove('active');
        });

        // Add 'active' class to the clicked button
        document.getElementById(buttonId).classList.add('active');
        document.getElementById("type_hiddenInput").value = buttonId
    }
    function toggleMode() {
        // Get the <link> element
        var styleSheet = document.getElementById("stylesheet");

        const body = document.body;
        const hiddenInput = document.getElementById("mode_hiddenInput");
        modeToggle= document.getElementById("toggle-circle");
        if (hiddenInput.value === 'light') {
            // Switch to dark mode
            body.classList.add("dark-mode");
            modeToggle.textContent = "☀️"; // Sun icon
            modeToggle.style.backgroundColor = "#3498db"; // Light mode button color
            hiddenInput.value = 'dark';
            // Change the href attribute to the new stylesheet
            styleSheet.href = "static/styles/setup_2/dark_style.css";
        } else {
            // Switch to light mode
            body.classList.remove("dark-mode");
            modeToggle.textContent = "🌙"; // Moon icon
            modeToggle.style.backgroundColor = "rgb(50,50,50)"; // Dark mode button color
            hiddenInput.value = 'light';
            // Change the href attribute to the new stylesheet
            styleSheet.href = "static/styles/setup_2/light_style.css";
        }
        document.getElementById('set_mode_form').submit();
    }
    function updateSliderValue() {
        var slider = document.getElementById("num_of_examples");
        var output = document.getElementById("sliderValue");
        output.innerHTML = "عدد الأمثلة: " + slider.value;
    }
    document.getElementById('examples_search_form').addEventListener('submit', function(event) {
        var wordInput = document.getElementById('word_input').value.trim();

        if (wordInput === "") {
            event.preventDefault();
            document.getElementById('word_input').style.borderColor = 'red';

            // Change the border color back to default after 2 seconds
            setTimeout(function () {

                document.getElementById('word_input').style.borderColor = '#222140';
                alert("فضلاً, قم بإدخال الكلمة في الخانة المخصصة لذلك.");
            }, 150);
            return
        }
        document.getElementById("overlay").style.display = "flex";
        document.getElementById("loader").style.display = "flex";
    });
</script>

</body>
</html>
